(window.webpackJsonpassignment=window.webpackJsonpassignment||[]).push([[0],{118:function(e,t){},121:function(e,t,a){},122:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),r=a(57),o=a.n(r),i=a(14),c=a(30);a(67),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var l=a(58),m=a(2),u=a(3),d=new(function(){function e(){Object(m.a)(this,e),this.authenticated=!1}return Object(u.a)(e,[{key:"login",value:function(e,t){console.log(t),window.localStorage.setItem("isLoggedIn",!0),window.localStorage.setItem("token",t),this.authenticated=!0,e()}},{key:"logout",value:function(e){window.localStorage.setItem("isLoggedIn",!1),window.localStorage.setItem("token",null),this.authenticated=!1,e()}},{key:"isAuthenticated",value:function(){return!!window.localStorage.getItem("isLoggedIn")&&"false"!=window.localStorage.getItem("isLoggedIn")}},{key:"getToken",value:function(){return window.localStorage.getItem("token")}}]),e}()),h=function(e){var t=e.component,a=Object(l.a)(e,["component"]);return s.a.createElement(i.b,Object.assign({},a,{render:function(e){return d.isAuthenticated()?s.a.createElement(t,e):s.a.createElement(i.a,{to:{pathname:"/",state:{from:e.location}}})}}))},g=a(6),p=a(5),f=a(7),v=(a(35),function(e){function t(){return Object(m.a)(this,t),Object(g.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return s.a.createElement("div",{className:"nav-container"},s.a.createElement("div",{className:"nav-logo"},"Chat App"),s.a.createElement("div",{className:"nav-button",onClick:function(){return d.logout(function(){window.location.reload()})}},d.isAuthenticated()?"Logout":"Sign In"))}}]),t}(n.Component)),E=(a(72),function(e){function t(){return Object(m.a)(this,t),Object(g.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.props.online_user;return s.a.createElement("div",{className:"conversation btn"},s.a.createElement("div",{className:"media-body"},s.a.createElement("h5",{className:"media-heading",id:"contactName"},e.first_name),s.a.createElement("h5",{className:"media-heading",id:"contactName"},e.username),s.a.createElement("small",{className:"pull-right time"},"Online")))}}]),t}(n.Component)),b=function(e){function t(){return Object(m.a)(this,t),Object(g.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.props.online_users.map(function(e,t){return s.a.createElement(E,{key:t,index:t,online_user:JSON.parse(e)})});return s.a.createElement("div",{className:"row content-wrap"},e)}}]),t}(n.Component),w=a(17),y=a.n(w),N=function(e){return"https://chatingbunny.herokuapp.com/api/chat/".concat(e)},k=function(e){function t(){return Object(m.a)(this,t),Object(g.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this;setTimeout(function(){e.props.resetError()},2e3)}},{key:"render",value:function(){var e=this.props.error;return s.a.createElement("div",{className:"flash-container"},e)}}]),t}(n.Component),O=function(e){function t(){return Object(m.a)(this,t),Object(g.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(u.a)(t,[{key:"componentWillMount",value:function(){this.props.getMessage()}},{key:"render",value:function(){var e=this.props.messageList.map(function(e,t){return s.a.createElement("div",{className:"msg",key:t},s.a.createElement("div",{className:"media-body"},s.a.createElement("small",{className:"pull-right time"},s.a.createElement("i",{className:"fa fa-clock-o"})),s.a.createElement("h5",{className:"media-heading"},e.first_name," \xa0 (",e.username,")"),s.a.createElement("small",{className:"col-sm-11"},e.message)))});return s.a.createElement("div",{className:"row content-wrap messages",id:"autoscroll"},e)}}]),t}(n.Component),j=a(12),S=(a(89),a(61)),C=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(g.a)(this,Object(p.a)(t).call(this,e))).addEmoji=function(e){var t=e.native;a.setState({message:a.state.message+t})},a.showEmoji=function(){var e=document.getElementById("show");"none"==e.style.display?e.style.display="block":e.style.display="none"},a.state={message:""},a.messageSubmit=a.messageSubmit.bind(Object(j.a)(a)),a.handleChange=a.handleChange.bind(Object(j.a)(a)),a}return Object(f.a)(t,e),Object(u.a)(t,[{key:"handleChange",value:function(e){var t={};t[e.currentTarget.name]=e.currentTarget.value,this.setState(t)}},{key:"messageSubmit",value:function(){this.props.sendMessage(this.state.message),this.setState({message:""})}},{key:"render",value:function(){return s.a.createElement("div",{className:"row send-wrap"},s.a.createElement("div",{id:"show",style:{display:"none",position:"absolute",top:"5%",right:"0%"}},s.a.createElement(S.a,{onSelect:this.addEmoji})),s.a.createElement("div",{className:"send-message"},s.a.createElement("div",{className:"message-text"},s.a.createElement("textarea",{name:"message",onChange:this.handleChange,value:this.state.message,className:"no-resize-bar form-control",rows:"2",placeholder:"Write a message..."})),s.a.createElement("div",{className:"send-button"},s.a.createElement("a",{className:"btn",onClick:this.messageSubmit},"Send ",s.a.createElement("i",{className:"fa fa-send"})),s.a.createElement("button",{onClick:this.showEmoji},"Emoji"))))}}]),t}(n.Component);a(91);y.a.interceptors.request.use(function(e){var t=window.localStorage.getItem("token");return t&&(e.headers.authorization="Token "+t),e},function(e){return Promise.reject(e)});var L=null,I=function(e){function t(){var e;return Object(m.a)(this,t),(e=Object(g.a)(this,Object(p.a)(t).call(this))).sendMsg=function(e){L.send(JSON.stringify({type:"message",token:window.localStorage.getItem("token"),message:e}))},e.getMessage=function(){y.a.get(N("ListMessage/")).then(function(t){e.setState({messageList:t.data})}).catch(function(t){e.setState({error:"Something Went Wrong.."})})},e.resetError=function(){e.setState({error:""})},e.state={online_users:[],error:"",messageList:[]},e}return Object(f.a)(t,e),Object(u.a)(t,[{key:"componentWillMount",value:function(){var e=this;(L=new WebSocket("wss://chatingbunny.herokuapp.com/ws/chat/all/")).addEventListener("open",function(e){L.send(JSON.stringify({type:"online_users",token:window.localStorage.getItem("token")}))}),L.addEventListener("message",function(t){var a=JSON.parse(t.data);if("message"===a.handle_type){var n=e.state.messageList;n.push(a),e.setState({messageList:n},function(){var e=window.document.getElementById("autoscroll");e.scrollTo(0,e.scrollHeight)})}else e.setState(a)})}},{key:"render",value:function(){var e=this.state.error;return s.a.createElement("div",{className:"App"},s.a.createElement(v,null),e&&s.a.createElement(k,{error:e,resetError:this.resetError}),s.a.createElement("br",null),s.a.createElement("div",{className:"container fill"},s.a.createElement("div",{className:"row chat-wrap"},s.a.createElement("div",{className:"col-sm-3 panel-wrap"},s.a.createElement("div",{className:"col-sm-12 section-wrap"},s.a.createElement("div",{className:"row header-wrap"},s.a.createElement("div",{className:"chat-header col-sm-12"},s.a.createElement("h4",{id:"username"},"Online Users"))),s.a.createElement(b,{online_users:this.state.online_users}))),s.a.createElement("div",{className:"col-sm-9 panel-wrap"},s.a.createElement("div",{className:"col-sm-12 section-wrap",id:"Messages"},s.a.createElement("div",{className:"row header-wrap"},s.a.createElement("div",{className:"chat-header col-sm-12"},s.a.createElement("h4",null,"Conversation Title"),s.a.createElement("div",{className:"header-button"},s.a.createElement("a",{className:"btn pull-right info-btn"},s.a.createElement("i",{className:"fa fa-info-circle fa-lg"}))))),s.a.createElement(O,{messageList:this.state.messageList,getMessage:this.getMessage}),s.a.createElement(C,{sendMessage:this.sendMsg}))))))}}]),t}(n.Component),M=(a(121),function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(g.a)(this,Object(p.a)(t).call(this,e))).resetError=function(){a.setState({error:""})},d.isAuthenticated()&&a.props.history.push("/home"),a.state={username:"",password:"",confirm_pwd:"",name:"",usernameLogin:"",passwordLogin:"",error:""},a.handleSubmit=a.handleSubmit.bind(Object(j.a)(a)),a.handleChange=a.handleChange.bind(Object(j.a)(a)),a.handleLoginSubmit=a.handleLoginSubmit.bind(Object(j.a)(a)),a}return Object(f.a)(t,e),Object(u.a)(t,[{key:"handleSubmit",value:function(e){var t=this;e.preventDefault(),y.a.post(N("Register/"),this.state).then(function(e){alert("Successfully Logged in")}).catch(function(e){console.log(e.response),t.setState({error:"Something went wrong"})})}},{key:"handleChange",value:function(e){var t={};t[e.currentTarget.name]=e.currentTarget.value,this.setState(t)}},{key:"handleLoginSubmit",value:function(e){var t=this;e.preventDefault(),y.a.post(N("Login/"),{username:this.state.usernameLogin,password:this.state.passwordLogin}).then(function(e){console.log(e),d.login(function(){t.props.history.push("/home")},e.data.token)}).catch(function(e){t.setState({error:e.response.data.message})})}},{key:"openRegisterForm",value:function(e){document.getElementById("register-form").style.display="block",document.getElementById("login-form").style.display="none",document.getElementById("login-form-link").classList.remove("active"),e.currentTarget.classList.add("active"),e.preventDefault()}},{key:"openLoginForm",value:function(e){document.getElementById("register-form").style.display="none",document.getElementById("login-form").style.display="block",document.getElementById("register-form-link").classList.remove("active"),e.currentTarget.classList.add("active"),e.preventDefault()}},{key:"firstMethod",value:function(e){/[0-9]+/g.test(e.key)||e.preventDefault()}},{key:"secondMethod",value:function(e){/[a-zA-Z ]+/g.test(e.key)||e.preventDefault()}},{key:"render",value:function(){var e=this,t=this.state.error;return s.a.createElement("div",{style:{marginTop:100}},t&&s.a.createElement(k,{error:t,resetError:this.resetError}),s.a.createElement("div",{className:"container"},s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"col-md-6 col-md-offset-3"},s.a.createElement("div",{className:"panel panel-login"},s.a.createElement("div",{className:"panel-heading"},s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"col-xs-6"},s.a.createElement("a",{href:"#",onClick:function(t){return e.openLoginForm(t)},className:"active",id:"login-form-link"},"Login")),s.a.createElement("div",{className:"col-xs-6"},s.a.createElement("a",{href:"#",onClick:function(t){return e.openRegisterForm(t)},id:"register-form-link"},"Register"))),s.a.createElement("hr",null)),s.a.createElement("div",{className:"panel-body"},s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"col-lg-12"},s.a.createElement("form",{id:"login-form",role:"form",style:{display:"block"}},s.a.createElement("div",{className:"form-group"},s.a.createElement("input",{type:"text",name:"usernameLogin",id:"usernameLogin",value:this.state.usernameLogin,placeholder:"Mobile Number",className:"form-control",ref:"first",onKeyPress:function(t){return e.firstMethod(t)},maxLength:"10",pattern:"\\d{10}",onChange:this.handleChange})),s.a.createElement("div",{className:"form-group"},s.a.createElement("input",{type:"password",name:"passwordLogin",id:"passwordLogin",value:this.state.passwordLogin,className:"form-control",placeholder:"Password",onChange:this.handleChange})),s.a.createElement("div",{className:"form-group"},s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"col-sm-6 col-sm-offset-3"},s.a.createElement("input",{type:"submit",name:"login-submit",id:"login-submit",className:"form-control btn btn-login",onChange:this.handleChange,value:"Log In",onClick:this.handleLoginSubmit}))))),s.a.createElement("form",{id:"register-form",style:{display:"none"}},s.a.createElement("div",{className:"form-group",onSubmit:this.handleSubmit},s.a.createElement("input",{type:"text",name:"username",id:"usernname",value:this.state.username,className:"form-control",placeholder:"Mobile Number",ref:"first",onKeyPress:function(t){return e.firstMethod(t)},maxLength:"10",pattern:"\\d{10}",onChange:this.handleChange})),s.a.createElement("div",{className:"form-group"},s.a.createElement("input",{type:"text",name:"name",value:this.state.name,id:"name",className:"form-control",placeholder:"Name",ref:"second",onKeyPress:function(t){return e.secondMethod(t)},onChange:this.handleChange})),s.a.createElement("div",{className:"form-group"},s.a.createElement("input",{type:"password",name:"password",id:"password",value:this.state.password,className:"form-control",placeholder:"Password",onChange:this.handleChange})),s.a.createElement("div",{className:"form-group"},s.a.createElement("input",{type:"password",name:"confirm_pwd",id:"confirm_pwd",value:this.state.confirm_pwd,className:"form-control",placeholder:"Confirm Password",onChange:this.handleChange})),s.a.createElement("div",{className:"form-group"},s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"col-sm-6 col-sm-offset-3"},s.a.createElement("input",{type:"submit",name:"register-submit",id:"register-submit",className:"form-control btn btn-register",value:"Register Now",onClick:this.handleSubmit,onChange:this.handleChange})))))))))))))}}]),t}(n.Component));var _=document.getElementById("root");o.a.render(s.a.createElement(c.a,null,s.a.createElement(function(){return s.a.createElement("div",{className:"App"},s.a.createElement(i.d,null,s.a.createElement(i.b,{exact:!0,path:"/",component:M}),s.a.createElement(h,{path:"/home",component:I}),s.a.createElement(i.b,{path:"*",component:function(){return"404 NOT FOUND"}})))},null)),_),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},35:function(e,t,a){},62:function(e,t,a){e.exports=a(122)},67:function(e,t,a){},72:function(e,t,a){}},[[62,1,2]]]);
//# sourceMappingURL=main.2b1a0a3a.chunk.js.map